<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs" xmlns:ui="http://wixtoolset.org/schemas/v4/wxs/ui">
  <Package Name="MklinkUI"
           Manufacturer="MklinkUI"
           Version="1.0.0.0"
           UpgradeCode="12345678-1234-1234-1234-123456789abc"
           Scope="perMachine"
           InstallerVersion="500"
           Compressed="yes">

    <MajorUpgrade DowngradeErrorMessage="A newer version of [ProductName] is already installed." />

    <Feature Id="MainFeature" Title="MklinkUI" Level="1">
      <ComponentGroupRef Id="ProductComponents" />
    </Feature>

    <ui:WixUI Id="WixUI_Minimal" InstallDirectory="INSTALLFOLDER" />

    <Icon Id="AppIcon" SourceFile="..\\assets\\icons\\mklinkUI_icon.ico" />
    <Property Id="ARPPRODUCTICON" Value="AppIcon" />
  </Package>

  <Fragment>
    <StandardDirectory Id="ProgramFilesFolder">
      <Directory Id="INSTALLFOLDER" Name="MklinkUI" />
    </StandardDirectory>
    <StandardDirectory Id="ProgramMenuFolder" />
  </Fragment>

  <Fragment>
    <ComponentGroup Id="ProductComponents" Directory="INSTALLFOLDER">
      <Component Guid="*">
        <File Source="..\\src\\MklinkUI.App\\bin\\$(var.Configuration)\\net8.0-windows\\publish\\MklinkUI.App.exe" KeyPath="yes" />
        <Shortcut Id="StartMenuShortcut"
                  Directory="ProgramMenuFolder"
                  Name="MklinkUI"
                  WorkingDirectory="INSTALLFOLDER"
                  Icon="AppIcon"
                  Advertise="no" />
      </Component>
      <Component Guid="*">
        <RegistryValue Root="HKCU"
                       Key="Software\\MklinkUI"
                       Name="Installed"
                       Type="string"
                       Value="1"
                       KeyPath="yes" />
      </Component>
    </ComponentGroup>
  </Fragment>
</Wix>

